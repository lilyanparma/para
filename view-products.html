<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>قائمة المنتجات</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #fff5f7;
    }
    h1 {
      text-align: center;
      color: #d6336c;
    }
    /* حقل البحث */
    .search-container {
      max-width: 400px;
      margin: 0 auto 20px;
    }
    .search-container input {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .info-image-container {
  margin-top: 15px;
  text-align: center;
  width: 200px;
  height: 200px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-left: auto;
  margin-right: auto;
  overflow: hidden;
  border: 1px solid #ccc;
  border-radius: 10px;
  background-color: #f9f9f9;
}

.info-image-container img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}
    
    /* بطاقة المنتج */
    .product-card {
      border: 1px solid #ccc;
      border-radius: 5px;
      margin-bottom: 20px;
      overflow: hidden;
      display: none; /* Initially hide all products */
    }
    .product-card.visible {
      display: block; /* Show only visible products */
    }
    .product-header {
      background-color: #f2f2f2;
      padding: 10px;
      font-weight: bold;
      text-align: center;
    }
    .product-info {
      padding: 10px;
    }
    .product-info p {
      margin: 5px 0;
    }
    #noProducts {
      text-align: center;
      color: #888;
      font-style: italic;
    }
  </style>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js "></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js "></script>

  <!-- Firebase Setup -->
  <script src="firebase-setup.js"></script>
</head>
<body>

<h1>قائمة المنتجات</h1>

<!-- حقل البحث -->
<div class="search-container">
  <input type="text" id="searchProductInput" placeholder="ابحث عن منتج...">
</div>

<!-- حاوية عرض المنتجات -->
<div id="productsContainer">
  <div id="noProducts">لا توجد منتجات مضافة</div>
</div>

<script>
  // تخزين عالمي للمنتجات لتسهيل عملية البحث
  window.allProducts = {};

  // مستمع لبيانات "products" من Firebase لتحديث عرض المنتجات تلقائيًا
  firebase.database().ref('products').on('value', function(snapshot) {
    var products = snapshot.val();
    window.allProducts = products || {};
    displayProducts(products);
  });

  // دالة لعرض المنتجات
  function displayProducts(products) {
    var container = document.getElementById('productsContainer');
    container.innerHTML = ''; // مسح المحتوى الحالي

    if (!products || Object.keys(products).length === 0) {
      container.innerHTML = '<div id="noProducts">لا توجد منتجات مضافة</div>';
      return;
    }

    for (var key in products) {
      var product = products[key];

      var card = document.createElement('div');
      card.className = 'product-card visible'; // Add the "visible" class to show it initially

      var header = document.createElement('div');
      header.className = 'product-header';
      header.textContent = product.name;

      var info = document.createElement('div');
      info.className = 'product-info';
    var imageHtml = product.image 
  ? `<div class="info-image-container">
      <img src="${product.image}" alt="صورة المنتج">
    </div>`
  : "";

info.innerHTML = `
  <p><strong>السعر:</strong> ${parseFloat(product.price).toFixed(2)} درهم</p>
  <p><strong>الكمية:</strong> ${product.quantity}</p>
  ${imageHtml}
`;

      card.appendChild(header);
      card.appendChild(info);

      container.appendChild(card);
    }
  }

  // دالة البحث الفوري أثناء الكتابة
  document.getElementById('searchProductInput').addEventListener('input', function() {
    var searchTerm = this.value.toLowerCase();

    // تحديد جميع بطاقات المنتجات
    var productCards = document.querySelectorAll('.product-card');

    // تصفية المنتجات بناءً على البحث
    productCards.forEach(function(card) {
      var productName = card.querySelector('.product-header').textContent.toLowerCase();
      if (productName.includes(searchTerm)) {
        card.classList.add('visible'); // إظهار البطاقة إذا كانت مطابقة
      } else {
        card.classList.remove('visible'); // إخفاء البطاقة إذا لم تكن مطابقة
      }
    });
  });
</script>

</body>
</html>
